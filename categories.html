<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Categories</title>
    <link rel="stylesheet" href="styles.css">
    <script>
        function addToCart(productName, price) {
            alert(productName + " has been added to your cart at a price of $" + price + "!");
            window.location.href = "cart.html";
        }

        function showCategory() {
            var select = document.getElementById("categorySelect");
            var selectedCategory = select.value;
            var categories = document.getElementsByClassName("category");

            for (var i = 0; i < categories.length; i++) {
                if (selectedCategory === "all" || categories[i].id === selectedCategory) {
                    categories[i].style.display = "block";
                } else {
                    categories[i].style.display = "none";
                }
            }
        }

        // Fetch products from the server
        function fetchProducts() {
            fetch('fetchCategories.php')
                .then(response => response.json())
                .then(data => {
                    const categoriesContainer = document.getElementById('categoriesContainer');
                    data.forEach(product => {
                        const productDiv = document.createElement('div');
                        productDiv.id = product.categoryID;
                        productDiv.className = 'category';
                        productDiv.style.display = 'none';

                        const productTitle = document.createElement('h2');
                        productTitle.textContent = product.productName;
                        productDiv.appendChild(productTitle);

                        const productDetails = document.createElement('p');
                        productDetails.textContent = product.productDesc;
                        productDiv.appendChild(productDetails);

                        const productPrice = document.createElement('p');
                        productPrice.textContent = "Price: $" + product.price;
                        productDiv.appendChild(productPrice);

                        const productImage = document.createElement('img');
                        productImage.src = product.imagePath;
                        productImage.alt = product.productName;
                        productImage.width = 200;
                        productImage.height = 200;
                        productDiv.appendChild(productImage);

                        const addToCartButton = document.createElement('button');
                        addToCartButton.textContent = 'Add to Cart';
                        addToCartButton.onclick = function() {
                            addToCart(product.productName, product.price);
                        };
                        productDiv.appendChild(addToCartButton);

                        categoriesContainer.appendChild(productDiv);
                    });
                    showCategory();
                })
                .catch(error => console.error('Error fetching products:', error));
        }

        window.onload = function() {
            fetchProducts();
        };
    </script>
</head>
<body>
    <header>
        <h1>Categories</h1>
        <button style="float: right;" onclick="window.location.href='homePage.html'">Go to Home Page</button>
        
        <!-- Dropdown menu for category selection -->
        <select id="categorySelect" onchange="showCategory()">
            <option value="all">Select Category</option>
            <option value="1">PlayStation</option>
            <option value="2">XBOX</option>
            <option value="3">PC</option>
            <option value="4">Nintendo Switch</option>
            <option value="5">Accessories</option>
        </select>
    </header>
    <div id="categoriesContainer">
        <!-- Categories will be dynamically inserted here by JavaScript -->
    </div>

    <footer>
        <p>&copy; 2025 GameVault</p>
    </footer>
</body>
</html>